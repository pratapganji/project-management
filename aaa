
public boolean sendMessageCallReport(CallReportProtos.CallReport message) {
    try {
        SendResult<String, CallReportProtos.CallReport> sendResult =
            kafkaTemplateProto.send(topicCallReportProto, message)
                              .get(5000, TimeUnit.MILLISECONDS);

        logger.info("CallReport Result: offset={}", sendResult.getRecordMetadata().offset());
        return sendResult.getRecordMetadata().hasOffset();

    } catch (InterruptedException ie) {
        // âœ… Restore interrupt status to comply with S2142
        Thread.currentThread().interrupt();
        logger.error("Interrupted while sending Call Report to Kafka", ie);
        return false;

    } catch (TimeoutException te) {
        logger.error("Timeout while sending Call Report to Kafka", te);
        // Optional: attempt to cancel the send (won't interrupt if already running)
        // kafkaTemplateProto.send(topicCallReportProto, message).cancel(true);
        return false;

    } catch (ExecutionException ee) {
        logger.error("Failed to send Call Report to Kafka (execution error)", ee);
        return false;
    }
}
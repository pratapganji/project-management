def get_db_details_impala(db_conf, env):
    home_dir = os.environ["HOME"]
    base_path = os.path.join(os.environ["HOME"], ".schema_browser/config/")
    api_env = "prod" if env in ["prod", "cob", "sb_prod", "sb_cob"] else env.split("_")[-1]

    # This should be the decrypted password exported by fetch_secret.sh
    impala_password = os.getenv("SECRET_IMPALA_NICK_NAME")

    # If Impala is NOT being used, don't treat it as an error.
    if not impala_password:
        log.info("SECRET_IMPALA_NICK_NAME not set. Skipping Impala JDBC configuration.")
        return None

    return {
        "properties": {
            # UID is your username/FID
            "username": db_conf.get("UID"),
            # Password must come from the secret (not UID)
            "password": impala_password,
            "ENV": api_env,
            "datasource": "STARBURST",
            "upperCaseColumns": "",
            "queryTimeout": "3000",
        },
        "classname": "net.citi.olympus.jdbc.driver.OlympusDriver",
        "url": "jdbc:olympus",
        "jarFile": os.path.join(base_path, "olympus-jdbc-driver-2.0.10.jar"),
    }